<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://zxq2233.github.io/aardio.github.io/</id>
    <title>Gridea</title>
    <updated>2022-03-13T03:39:59.794Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://zxq2233.github.io/aardio.github.io/"/>
    <link rel="self" href="https://zxq2233.github.io/aardio.github.io/atom.xml"/>
    <subtitle>温故而知新</subtitle>
    <logo>https://zxq2233.github.io/aardio.github.io/images/avatar.png</logo>
    <icon>https://zxq2233.github.io/aardio.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, Gridea</rights>
    <entry>
        <title type="html"><![CDATA[aardio调用记事本打开txt文件]]></title>
        <id>https://zxq2233.github.io/aardio.github.io/post/aardio-diao-yong-ji-shi-ben-da-kai-txt-wen-jian/</id>
        <link href="https://zxq2233.github.io/aardio.github.io/post/aardio-diao-yong-ji-shi-ben-da-kai-txt-wen-jian/">
        </link>
        <updated>2022-03-13T03:37:30.000Z</updated>
        <content type="html"><![CDATA[<pre><code class="language-javascript">import win.ui;
import console;
/*DSG{{*/
mainForm = win.form(text=&quot;aardio工程&quot;;right=959;bottom=591)
mainForm.add(
button={cls=&quot;button&quot;;text=&quot;Button&quot;;left=79;top=65;right=234;bottom=146;z=1};
button2={cls=&quot;button&quot;;text=&quot;Button&quot;;left=206;top=301;right=463;bottom=428;z=2}
)
/*}}*/

import process;

 process.shell(&quot;notepad&quot;,&quot;./1.txt&quot;,&quot;open&quot;,SW_SHOW);


mainForm.show();
return win.loopMessage();
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[aardio使用LODOP打印机打印条码]]></title>
        <id>https://zxq2233.github.io/aardio.github.io/post/aardio-shi-yong-lodop-da-yin-ji-da-yin-tiao-ma/</id>
        <link href="https://zxq2233.github.io/aardio.github.io/post/aardio-shi-yong-lodop-da-yin-ji-da-yin-tiao-ma/">
        </link>
        <updated>2022-03-13T03:08:14.000Z</updated>
        <content type="html"><![CDATA[<h2 id="主文件代码">主文件代码</h2>
<pre><code class="language-javascript">import win.ui;
import web.form;
/*DSG{{*/
mainForm = win.form(text=&quot;aardio工程2&quot;;right=959;bottom=591)
mainForm.add(
button={cls=&quot;button&quot;;text=&quot;Button&quot;;left=97;top=433;right=217;bottom=480;z=2};
custom={cls=&quot;custom&quot;;text=&quot;自定义控件&quot;;left=23;top=21;right=773;bottom=376;z=1}
)
/*}}*/

var mb = web.form(mainForm.custom);

//使用浏览器打开网页
mb.go(&quot;\page\1.html&quot;);


mainForm.button.oncommand = function(id,event){
	mb.script.ppreview(&quot;2333&quot;,&quot;户数&quot;);
}


mainForm.show();
win.loopMessage();
</code></pre>
<h2 id="printhtml文件代码">print.html文件代码</h2>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;打印预览&lt;/title&gt;
    &lt;script src='./LodopFuncs.js'&gt;&lt;/script&gt;
    &lt;object id=&quot;LODOP_OB&quot; classid=&quot;clsid:2105C259-1E0C-4534-8141-A753534CB4CA&quot; width=0 height=0&gt;
        &lt;embed id=&quot;LODOP_EM&quot; type=&quot;application/x-print-lodop&quot; width=0 height=0&gt;&lt;/embed&gt;
    &lt;/object&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;a href=&quot;javascript:ppreview()&quot;&gt;&lt;b&gt;打印预览&lt;/b&gt;&lt;/a&gt;
    &lt;script&gt;
        var LODOP; //声明为全局变量  
        function ppreview(code, name) {
            LODOP = getLodop();

            LODOP.PRINT_INITA(0, 0, 378, 378, &quot;&quot;);
            LODOP.SET_PRINT_PAGESIZE(0, 1000, 1000, &quot;&quot;);
            LODOP.ADD_PRINT_TEXT(38, 69, 102, 31, name);
            LODOP.SET_PRINT_STYLEA(0, &quot;FontSize&quot;, 19);
            LODOP.ADD_PRINT_TEXT(90, 69, 78, 16, &quot;11&quot;);
            LODOP.ADD_PRINT_BARCODE(126, 61, 239, 130, &quot;QRCode&quot;, code);
            LODOP.SET_PRINT_STYLEA(0, &quot;FontSize&quot;, 14);

            /*LODOP.PRINT_INITA(0, 0, 800, 1600, &quot;BH&quot;);
            LODOP.SET_PRINT_PAGESIZE(1, &quot;100mm&quot;, &quot;100mm&quot;, &quot;&quot;);

            LODOP.ADD_PRINT_TEXT(20, 10, 500, 25, &quot;唛头：TA123455&quot;);
            LODOP.SET_PRINT_STYLEA(1, &quot;FontName&quot;, &quot;Swis721 BlkCn BT&quot;);
            LODOP.SET_PRINT_STYLEA(1, &quot;FontSize&quot;, 18);

            LODOP.SET_PRINT_STYLE(&quot;FontSize&quot;, 18)
            LODOP.ADD_PRINT_TEXT(20, 330, 500, 25, &quot;1件&quot;);

            LODOP.SET_PRINT_STYLE(&quot;FontSize&quot;, 13)
            LODOP.ADD_PRINT_TEXT(53, 10, 500, 20, &quot;品名：中国东莞广东    2021-08-20 14:27:52&quot;);

            LODOP.SET_PRINT_STYLE(&quot;FontSize&quot;, 13)
            LODOP.ADD_PRINT_TEXT(80, 10, 500, 20, &quot;参数：TA1,31KG，999CBM    业务员:黄X玲&quot;);
            LODOP.ADD_PRINT_BARCODE(120, 20, 350, 64, &quot;128C&quot;, &quot;1234567890&quot;);
            LODOP.SET_PRINT_STYLEA(0, &quot;GroundColor&quot;, &quot;#0080FF&quot;);*/

            LODOP.PREVIEW();

        };

        function aa() {
            alert(&quot;a+b&quot;);
            return 0;
        }
    &lt;/script&gt;

&lt;/body&gt;
&lt;!-- http://demo.sinoverse.cn/lodop_print/--&gt;
&lt;/html&gt;
</code></pre>
<p>#LodopFuncs.js文件内容</p>
<pre><code class="language-javascript">//==本JS是加载Lodop插件及CLodop服务的综合示例，可直接使用，建议看懂后融进自己页面程序==

var CreatedOKLodopObject, CLodopIsLocal, CLodopJsState;

//==判断是否需要CLodop(那些不支持插件的浏览器):==
function needCLodop() {
    try {
        var ua = navigator.userAgent;
        if (ua.match(/Windows\sPhone/i))
            return true;
        if (ua.match(/iPhone|iPod|iPad/i))
            return true;
        if (ua.match(/Android/i))
            return true;
        if (ua.match(/Edge\D?\d+/i))
            return true;

        var verTrident = ua.match(/Trident\D?\d+/i);
        var verIE = ua.match(/MSIE\D?\d+/i);
        var verOPR = ua.match(/OPR\D?\d+/i);
        var verFF = ua.match(/Firefox\D?\d+/i);
        var x64 = ua.match(/x64/i);
        if ((!verTrident) &amp;&amp; (!verIE) &amp;&amp; (x64))
            return true;
        else if (verFF) {
            verFF = verFF[0].match(/\d+/);
            if ((verFF[0] &gt;= 41) || (x64))
                return true;
        } else if (verOPR) {
            verOPR = verOPR[0].match(/\d+/);
            if (verOPR[0] &gt;= 32)
                return true;
        } else if ((!verTrident) &amp;&amp; (!verIE)) {
            var verChrome = ua.match(/Chrome\D?\d+/i);
            if (verChrome) {
                verChrome = verChrome[0].match(/\d+/);
                if (verChrome[0] &gt;= 41)
                    return true;
            }
        }
        return false;
    } catch (err) {
        return true;
    }
}

//加载CLodop时用双端口(http是8000/18000,而https是8443/8444)以防其中某端口被占,
//主JS文件“CLodopfuncs.js”是固定文件名，其内容是动态的，与当前打印环境有关:
function loadCLodop() {
    if (CLodopJsState == &quot;loading&quot; || CLodopJsState == &quot;complete&quot;) return;
    CLodopJsState = &quot;loading&quot;;
    var head = document.head || document.getElementsByTagName(&quot;head&quot;)[0] || document.documentElement;
    var JS1 = document.createElement(&quot;script&quot;);
    var JS2 = document.createElement(&quot;script&quot;);

    if (window.location.protocol=='https:') {
      JS1.src = &quot;https://localhost.lodop.net:8443/CLodopfuncs.js&quot;;
      JS2.src = &quot;https://localhost.lodop.net:8444/CLodopfuncs.js&quot;;
    } else {
      JS1.src = &quot;http://localhost:8000/CLodopfuncs.js&quot;;
      JS2.src = &quot;http://localhost:18000/CLodopfuncs.js&quot;;
    }
    JS1.onload  = JS2.onload  = function()    {CLodopJsState = &quot;complete&quot;;}
    JS1.onerror = JS2.onerror = function(evt) {CLodopJsState = &quot;complete&quot;;}
    head.insertBefore(JS1, head.firstChild);
    head.insertBefore(JS2, head.firstChild);
    CLodopIsLocal = !!((JS1.src + JS2.src).match(/\/\/localho|\/\/127.0.0./i));
}

if (needCLodop()){loadCLodop();}//开始加载

//==获取LODOP对象主过程,判断是否安装、需否升级:==
function getLodop(oOBJECT, oEMBED) {
    var strHtmInstall = &quot;&lt;br&gt;&lt;font color='#FF00FF'&gt;打印控件未安装!点击这里&lt;a href='install_lodop32.exe' target='_self'&gt;执行安装&lt;/a&gt;,安装后请刷新页面或重新进入。&lt;/font&gt;&quot;;
    var strHtmUpdate = &quot;&lt;br&gt;&lt;font color='#FF00FF'&gt;打印控件需要升级!点击这里&lt;a href='install_lodop32.exe' target='_self'&gt;执行升级&lt;/a&gt;,升级后请重新进入。&lt;/font&gt;&quot;;
    var strHtm64_Install = &quot;&lt;br&gt;&lt;font color='#FF00FF'&gt;打印控件未安装!点击这里&lt;a href='install_lodop64.exe' target='_self'&gt;执行安装&lt;/a&gt;,安装后请刷新页面或重新进入。&lt;/font&gt;&quot;;
    var strHtm64_Update = &quot;&lt;br&gt;&lt;font color='#FF00FF'&gt;打印控件需要升级!点击这里&lt;a href='install_lodop64.exe' target='_self'&gt;执行升级&lt;/a&gt;,升级后请重新进入。&lt;/font&gt;&quot;;
    var strHtmFireFox = &quot;&lt;br&gt;&lt;br&gt;&lt;font color='#FF00FF'&gt;（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】-&gt;【附加组件】-&gt;【扩展】中先卸它）&lt;/font&gt;&quot;;
    var strHtmChrome = &quot;&lt;br&gt;&lt;br&gt;&lt;font color='#FF00FF'&gt;(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）&lt;/font&gt;&quot;;
    var strCLodopInstall_1 = &quot;&lt;br&gt;&lt;font color='#FF00FF'&gt;Web打印服务CLodop未安装启动，点击这里&lt;a href='CLodop_Setup_for_Win32NT.exe' target='_self'&gt;下载执行安装&lt;/a&gt;&quot;;
    var strCLodopInstall_2 = &quot;&lt;br&gt;（若此前已安装过，可&lt;a href='CLodop.protocol:setup' target='_self'&gt;点这里直接再次启动&lt;/a&gt;）&quot;;
    var strCLodopInstall_3 = &quot;，成功后请刷新或重启浏览器。&lt;/font&gt;&quot;;
    var strCLodopUpdate = &quot;&lt;br&gt;&lt;font color='#FF00FF'&gt;Web打印服务CLodop需升级!点击这里&lt;a href='CLodop_Setup_for_Win32NT.exe' target='_self'&gt;执行升级&lt;/a&gt;,升级后请刷新或重启浏览器。&lt;/font&gt;&quot;;
    var LODOP;
    try {
        var ua = navigator.userAgent;
        var isIE = !!(ua.match(/MSIE/i)) || !!(ua.match(/Trident/i));
        if (needCLodop()) {
            try {
                LODOP = getCLodop();
            } catch (err) {}
            if (!LODOP &amp;&amp; CLodopJsState !== &quot;complete&quot;) {
                if (CLodopJsState == &quot;loading&quot;) alert(&quot;网页还没下载完毕，请稍等一下再操作.&quot;); else alert(&quot;没有加载CLodop的主js，请先调用loadCLodop过程.&quot;);
                return;
            }
            if (!LODOP) {
                document.body.innerHTML = strCLodopInstall_1 + (CLodopIsLocal ? strCLodopInstall_2 : &quot;&quot;) + strCLodopInstall_3 + document.body.innerHTML;
                return;
            } else {
                if (CLODOP.CVERSION &lt; &quot;4.1.5.5&quot;) {
                    document.body.innerHTML = strCLodopUpdate + document.body.innerHTML;
                }
                if (oEMBED &amp;&amp; oEMBED.parentNode)
                    oEMBED.parentNode.removeChild(oEMBED); //清理旧版无效元素
                if (oOBJECT &amp;&amp; oOBJECT.parentNode)
                    oOBJECT.parentNode.removeChild(oOBJECT);
            }
        } else {
            var is64IE = isIE &amp;&amp; !!(ua.match(/x64/i));
            //==如果页面有Lodop就直接使用,否则新建:==
            if (oOBJECT || oEMBED) {
                if (isIE)
                    LODOP = oOBJECT;
                else
                    LODOP = oEMBED;
            } else if (!CreatedOKLodopObject) {
                LODOP = document.createElement(&quot;object&quot;);
                LODOP.setAttribute(&quot;width&quot;, 0);
                LODOP.setAttribute(&quot;height&quot;, 0);
                LODOP.setAttribute(&quot;style&quot;, &quot;position:absolute;left:0px;top:-100px;width:0px;height:0px;&quot;);
                if (isIE)
                    LODOP.setAttribute(&quot;classid&quot;, &quot;clsid:2105C259-1E0C-4534-8141-A753534CB4CA&quot;);
                else
                    LODOP.setAttribute(&quot;type&quot;, &quot;application/x-print-lodop&quot;);
                document.documentElement.appendChild(LODOP);
                CreatedOKLodopObject = LODOP;
            } else
                LODOP = CreatedOKLodopObject;
            //==Lodop插件未安装时提示下载地址:==
            if ((!LODOP) || (!LODOP.VERSION)) {
                if (ua.indexOf('Chrome') &gt;= 0)
                    document.body.innerHTML = strHtmChrome + document.body.innerHTML;
                if (ua.indexOf('Firefox') &gt;= 0)
                    document.body.innerHTML = strHtmFireFox + document.body.innerHTML;
                document.body.innerHTML = (is64IE ? strHtm64_Install : strHtmInstall) + document.body.innerHTML;
                return LODOP;
            }
        }
        if (LODOP.VERSION &lt; &quot;6.2.2.6&quot;) {
            if (!needCLodop())
                document.body.innerHTML = (is64IE ? strHtm64_Update : strHtmUpdate) + document.body.innerHTML;
        }
        //===如下空白位置适合调用统一功能(如注册语句、语言选择等):==


        //=======================================================
        return LODOP;
    } catch (err) {
        alert(&quot;getLodop出错:&quot; + err);
    }
}

</code></pre>
]]></content>
    </entry>
</feed>